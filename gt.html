<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Kategorili Adam Asmaca - Ä°pucu + PuanlÄ± | 300+ Kelime</title>

<!-- Firebase ekleme (puanlarÄ± bakiyeye yazabilmek iÃ§in) -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
  body {
    margin:0; padding:0; background:#1a1a2e; color:#eee; font-family: 'Segoe UI', sans-serif;
    display:flex; flex-direction:column; align-items:center; min-height:100vh;
  }
  h1 { margin:20px; color:#00ff88; text-shadow:0 0 10px #00ff88; }
  #skorlar { 
    background:#16213e; padding:10px 20px; border-radius:10px; font-size:18px; 
    margin:10px; color:#00ff88; text-align:center;
  }
  #kategori { font-size:22px; margin:10px; padding:10px 20px; background:#16213e; border-radius:10px; }
  #kelime { font-size:48px; letter-spacing:5px; margin:20px; font-weight:bold; }
  #harfler { display:flex; flex-wrap:wrap; gap:10px; max-width:600px; justify-content:center; margin:20px; }
  .harf {
    width:50px; height:50px; background:#0f3460; border-radius:10px; font-size:24px; cursor:pointer;
    display:flex; align-items:center; justify-content:center; transition:0.3s;
  }
  .harf:hover { background:#e94560; transform:scale(1.1); }
  .harf.kullanildi { background:#333; pointer-events:none; opacity:0.5; }
  #adam { width:250px; height:250px; margin:20px; position:relative; }
  svg { width:100%; height:100%; }
  #bilgi { margin:10px; font-size:18px; }
  button { margin:15px; padding:12px 30px; background:#e94560; border:none; color:white; font-size:18px; border-radius:10px; cursor:pointer; transition:0.3s; }
  button:hover:not(:disabled) { background:#ff6b6b; transform:scale(1.05); }
  button:disabled {
    background: #333 !important;
    color: #aaa;
    cursor: not-allowed;
    opacity: 0.7;
  }
  #ipucuBtn {
    background: #00ff88 !important;
    color: #000;
  }
  #ipucuBtn:hover:not(:disabled) {
    background: #00cc66 !important;
  }
  .dogru { color:#00ff88; }
  .yanlis { color:#e94560; }
  #modal {
    display:none; position:fixed; top:0; left:0; width:100%; height:100%; 
    background:rgba(0,0,0,0.9); z-index:1000; 
    align-items:center; justify-content:center;
  }
  #modalIci {
    background:#16213e; padding:40px; border-radius:20px; text-align:center; 
    max-width:500px; box-shadow:0 0 30px #00ff88;
  }
  #modalTitle { color:#00ff88; font-size:32px; margin:0 0 20px 0; }
  #modalText { font-size:20px; margin:20px 0; line-height:1.5; }
</style>
</head>
<body>

<h1>ðŸŽ® ADAM ASMACA - Ä°PUCU & PUANLI ðŸŽ®</h1>
<div id="skorlar">
  En YÃ¼ksek: <span id="enYuksek">0</span> pts | 
  Toplam Puan: <span id="toplamPuan">0</span> pts | 
  Kazanma OranÄ±: <span id="kazanmaOran">0%</span>
</div>
<div id="kategori">Kategori seÃ§iniz...</div>
<div id="kelime"></div>
<div id="harfler"></div>
<div id="adam">
  <svg viewBox="0 0 200 200">
    <!-- Zemin ve direk -->
    <line x1="10" y1="190" x2="100" y2="190" stroke="#eee" stroke-width="8"/>
    <line x1="50" y1="190" x2="50" y2="20" stroke="#eee" stroke-width="8"/>
    <line x1="50" y1="20" x2="120" y2="20" stroke="#eee" stroke-width="8"/>
    <line x1="120" y1="20" x2="120" y2="50" stroke="#eee" stroke-width="6"/>
    
    <!-- Adam parÃ§alarÄ± (baÅŸlangÄ±Ã§ta gizli) -->
    <circle id="kafa" cx="120" cy="65" r="15" stroke="#eee" stroke-width="4" fill="none" opacity="0"/>
    <line id="govde" x1="120" y1="80" x2="120" y2="130" stroke="#eee" stroke-width="4" opacity="0"/>
    <line id="solkol" x1="120" y1="100" x2="90" y2="110" stroke="#eee" stroke-width="4" opacity="0"/>
    <line id="sagkol" x1="120" y1="100" x2="150" y2="110" stroke="#eee" stroke-width="4" opacity="0"/>
    <line id="solbac" x1="120" y1="130" x2="100" y2="170" stroke="#eee" stroke-width="4" opacity="0"/>
    <line id="sagbac" x1="120" y1="130" x2="140" y2="170" stroke="#eee" stroke-width="4" opacity="0"/>
  </svg>
</div>
<div id="bilgi">Kalan hak: 6</div>
<button onclick="yeniOyun()">Yeni Oyun</button>
<button id="ipucuBtn" onclick="ipucuAl()" disabled>Ä°pucu Al</button>

<!-- Modal -->
<div id="modal">
  <div id="modalIci">
    <h2 id="modalTitle"></h2>
    <p id="modalText"></p>
    <button onclick="modalKapat()">Yeni Oyun Oyna! ðŸš€</button>
  </div>
</div>

<script>
/* Firebase init (aynÄ± config ile) */
const firebaseConfig = {
  apiKey: "AIzaSyBlirRiiNPpdqmTAmq6DsSq8mCUlgBHgVc",
  authDomain: "lilemir-new.firebaseapp.com",
  projectId: "lilemir-new",
  storageBucket: "lilemir-new.firebasestorage.app",
  messagingSenderId: "339863121380",
  appId: "1:339863121380:web:123195552e821b085e6bf1"
};
if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// â‰ˆ 300 kelime, 15 kategoride (boÅŸluklu kelimeler destekli!)
const kelimeler = {
  "Meyveler": ["elma","armut","kiraz","muz","portakal","Ã§ilek","karpuz","Ã¼zÃ¼m","ayva","incir","nar","kivi","ananas","mango","avokado","ÅŸeftali","kayÄ±sÄ±","erik","viÅŸne","limon"],
  "Sebzeler": ["domates","salatalÄ±k","biber","patates","soÄŸan","sarÄ±msak","havuÃ§","kabak","patlÄ±can","Ä±spanak","lahana","brokoli","karnabahar","marul","roka","maydanoz","tere","pÄ±rasa","kereviz","enginar"],
  "Hayvanlar": ["kedi","kÃ¶pek","kuÅŸ","aslan","kaplan","fil","zÃ¼rafa","maymun","timsah","yÄ±lan","kurbaÄŸa","balÄ±k","kÃ¶pekbalÄ±ÄŸÄ±","yunus","baykuÅŸ","kartal","penguen","kanguru","koala","panda"],
  "Renkler": ["kÄ±rmÄ±zÄ±","mavi","yeÅŸil","sarÄ±","turuncu","mor","pembe","kahverengi","siyah","beyaz","gri","turkuaz","lacivert","bordo","altÄ±n","gÃ¼mÃ¼ÅŸ"],
  "Ãœlkeler": ["tÃ¼rkiye","almanya","fransa","ingiltere","ispanya","italya","rusya","Ã§in","japonya","brezilya","kanada","avustralya","mÄ±sÄ±r","hindistan","yunanistan","norveÃ§","isveÃ§","portekiz","arnavutluk","gÃ¼neykorea"],
  "Meslekler": ["doktor","Ã¶ÄŸretmen","polis","avukat","mÃ¼hendis","aÅŸÃ§Ä±","berber","kasiyer","ÅŸofÃ¶r","ressam","mimar","gazeteci","aktÃ¶r","mÃ¼zisyen","futbolcu","hakim","hemÅŸire","eczacÄ±","diÅŸÃ§i","pilot"],
  "EÅŸyalar": ["kalem","defter","telefon","bilgisayar","televizyon","saat","gÃ¶zlÃ¼k","ayakkabÄ±","Ã§anta","ÅŸemsiye","anahtar","lamba","tabak","bardak","kaÅŸÄ±k","Ã§atal","bÄ±Ã§ak","sandalye","masa","yatak"],
  "Sporlar": ["futbol","basketbol","voleybol","tenis","yÃ¼zme","koÅŸu","bisiklet","jimnastik","karate","judo","boks","masatenisi","hentbol","gÃ¼reÅŸ","atletizm","kayak","sÃ¶rf","binicilik"],
  "Yiyecekler": ["pizza","hamburger","dÃ¶ner","lahmacun","kÃ¶fte","pide","mantÄ±","bÃ¶rek","karnÄ±yarÄ±k","musakka","sarma","dolma","kuru fasulye","nohut","mercimek","pilav","makarna","tavuk","balÄ±k"],
  "Markalar": ["apple","samsung","toyota","mercedes","nike","adidas","coca cola","pepsi","netflix","spotify","instagram","twitter","google","amazon","microsoft","bmw","audi","volkswagen","ford","porsche"],
  "Film/Dizi": ["inception","titanic","avatar","matrix","godfather","star wars","harry potter","lord of the rings","breaking bad","game of thrones","friends","stranger things","interstellar","pulp fiction","joker","parasite","shrek","frozen"],
  "Åžehirler": ["istanbul","ankara","izmir","bursa","antalya","adana","konya","gaziantep","ÅŸanlÄ±urfa","kayseri","eskisehir","samsun","trabzon","malatya","van","diyarbakÄ±r","edirne","muÄŸla","bodrum","Ã§anakkale"],
  "Bitkiler": ["gÃ¼l","lale","papatya","orkide","kaktÃ¼s","menekÅŸe","zambak","sÃ¼mbÃ¼l","fÄ±stÄ±k Ã§amÄ±","Ã§Ä±nar","kavak","meÅŸe","defne","nane","fesleÄŸen","kekik","biberiye","lavanta"],
  "MÃ¼zik Aletleri": ["gitar","piyano","davul","keman","org","ney","saz","baÄŸlama","ud","kanun","klarnet","trompet","yan flÃ¼t","akordeon","bateria","arp","mandolin"],
  "VÃ¼cut": ["baÅŸ","gÃ¶z","kulak","burun","aÄŸÄ±z","diÅŸ","boyun","omuz","kol","el","parmak","gÃ¶ÄŸÃ¼s","karÄ±n","bacak","diz","ayak","sÄ±rt","bel","kalp","beyin"]
};

let secilenKategori, secilenKelime, kelimeArray, gorunenArray, yanlisSayisi, kullanilanHarfler, usedHint;
let skorlar = JSON.parse(localStorage.getItem('asmacaSkorlar')) || {toplamOyun:0, kazananOyun:0, toplamPuan:0, enYuksek:0};

function guncelleSkorUI() {
  document.getElementById('enYuksek').textContent = skorlar.enYuksek;
  document.getElementById('toplamPuan').textContent = skorlar.toplamPuan;
  const oran = skorlar.toplamOyun > 0 ? Math.round((skorlar.kazananOyun / skorlar.toplamOyun) * 100) : 0;
  document.getElementById('kazanmaOran').textContent = oran + '%';
}

function skorGuncelle(puan, kazandi) {
  skorlar.toplamOyun++;
  if (kazandi) {
    skorlar.kazananOyun++;
    skorlar.toplamPuan += puan;
    if (puan > skorlar.enYuksek) skorlar.enYuksek = puan;
  }
  localStorage.setItem('asmacaSkorlar', JSON.stringify(skorlar));
  guncelleSkorUI();
}

/* --- KullanÄ±cÄ±ya bakiye ekleme (her puan = 0.01 USD = 1 cent) --- */
async function creditUserFromPoints(points) {
  // points -> each point is 1 cent => dollars = points * 0.01
  if (!auth || !auth.currentUser) return;
  if (!points || points <= 0) return;
  const amountUsd = Number((points * 0.01).toFixed(2));
  try {
    const uid = auth.currentUser.uid;
    const userRef = db.collection('users').doc(uid);
    await db.runTransaction(async (tx) => {
      const doc = await tx.get(userRef);
      if (!doc.exists) {
        tx.set(userRef, { balance: amountUsd, moneyEarned: amountUsd }, { merge: true });
      } else {
        const cur = Number(doc.data().balance || 0);
        const curEarn = Number(doc.data().moneyEarned || 0);
        tx.update(userRef, { balance: cur + amountUsd, moneyEarned: curEarn + amountUsd });
      }
    });
    try { showToast && showToast(`+${amountUsd}$ bakiyene eklendi.`, true, 4000); } catch(e){}
  } catch (e) {
    console.error("Credit hatasÄ±:", e);
  }
}

function modalGoster(baslik, metin) {
  document.getElementById('modalTitle').innerHTML = baslik;
  document.getElementById('modalText').innerHTML = metin;
  document.getElementById('modal').style.display = 'flex';
  // TÃ¼m butonlarÄ± devre dÄ±ÅŸÄ±
  document.querySelectorAll('.harf').forEach(h => {
    h.style.pointerEvents = 'none';
  });
  document.getElementById('ipucuBtn').disabled = true;
}

function modalKapat() {
  document.getElementById('modal').style.display = 'none';
  yeniOyun();
}

function yeniOyun() {
  const kategoriler = Object.keys(kelimeler);
  secilenKategori = kategoriler[Math.floor(Math.random() * kategoriler.length)];
  const liste = kelimeler[secilenKategori];
  secilenKelime = liste[Math.floor(Math.random() * liste.length)].toUpperCase();
  
  kelimeArray = secilenKelime.split('');
  gorunenArray = kelimeArray.map(c => /[A-ZÃ‡ÄžIÄ°Ã–PRSÅžTUÃœVYZ]/.test(c) ? '_' : c );
  
  yanlisSayisi = 0;
  kullanilanHarfler = [];
  usedHint = false;
  
  document.getElementById('kategori').textContent = "Kategori: " + secilenKategori.toUpperCase();
  document.getElementById('kelime').textContent = gorunenArray.join(' ');
  document.getElementById('bilgi').textContent = "Kalan hak: 6";
  document.getElementById('bilgi').style.color = "#eee";
  
  // AdamÄ± sÄ±fÄ±rla
  ["kafa","govde","solkol","sagkol","solbac","sagbac"].forEach(id => {
    document.getElementById(id).style.opacity = "0";
  });
  
  // Ä°pucu butonunu sÄ±fÄ±rla
  const ipucuBtn = document.getElementById('ipucuBtn');
  ipucuBtn.disabled = false;
  ipucuBtn.textContent = 'Ä°pucu Al (1 hak)';
  
  // Harfleri oluÅŸtur
  const harfDiv = document.getElementById('harfler');
  harfDiv.innerHTML = "";
  "ABCÃ‡DEFÄžGHIÄ°JKLMNOÃ–PRSÅžTUÃœVYZ".split("").forEach(harf => {
    const btn = document.createElement('div');
    btn.className = "harf";
    btn.textContent = harf;
    btn.onclick = () => harfTiklandi(harf);
    harfDiv.appendChild(btn);
  });
}

async function handleWin(points, usedHintFlag) {
  // points is the calculated puan in game
  skorGuncelle(points, true);
  // kredi: each point = 1 cent
  await creditUserFromPoints(points);
  let ipucuText = usedHintFlag ? '<br>Ä°pucu kullandÄ±ÄŸÄ±n iÃ§in -100 puan.' : '';
  modalGoster("ðŸŽ‰ TEBRÄ°KLER! KAZANDIN! ðŸŽ‰", 
      `Kelime: ${secilenKelime}<br><strong>Bu oyunda ${points} puan kazandÄ±n!</strong>${ipucuText}<br>Harika iÅŸ!`);
}

async function harfTiklandi(harf) {
  if (kullanilanHarfler.includes(harf)) return;
  kullanilanHarfler.push(harf);
  
  const btn = event.target;
  btn.classList.add('kullanildi');
  
  if (kelimeArray.includes(harf)) {
    // DoÄŸru harf
    btn.style.background = "#00ff88";
    let changed = false;
    for(let i=0; i<kelimeArray.length; i++) {
      if(kelimeArray[i] === harf) {
        gorunenArray[i] = harf;
        changed = true;
      }
    }
    if(changed) {
      document.getElementById('kelime').textContent = gorunenArray.join(' ');
      
      // Kelime tamamlandÄ± mÄ±?
      if (!gorunenArray.includes("_")) {
        const puan = kelimeArray.length * 100 + (6 - yanlisSayisi) * 50 - (usedHint ? 100 : 0);
        await handleWin(puan, usedHint);
        return;
      }
    }
  } else {
    // YanlÄ±ÅŸ harf
    btn.style.background = "#e94560";
    yanlisSayisi++;
    document.getElementById('bilgi').textContent = "Kalan hak: " + (6 - yanlisSayisi);
    document.getElementById('bilgi').style.color = "#e94560";
    
    // AdamÄ± Ã§iz
    const parcalar = ["kafa","govde","solkol","sagkol","solbac","sagbac"];
    if (yanlisSayisi <= 6) {
      document.getElementById(parcalar[yanlisSayisi-1]).style.opacity = "1";
    }
    
    // Oyun bitti mi?
    if (yanlisSayisi >= 6) {
      skorGuncelle(0, false);
      modalGoster("ðŸ˜¢ ÃœZGÃœNÃœM, KAYBETTÄ°N! ðŸ’€", 
        `DoÄŸru kelime: <strong>${secilenKelime}</strong><br>Tekrar dene ve rekorunu kÄ±r!`);
    }
  }
}

async function ipucuAl() {
  if (usedHint || !gorunenArray.includes('_')) {
    return;
  }
  
  usedHint = true;
  
  // Gizli pozisyonlarÄ± bul
  const positions = [];
  for(let i = 0; i < gorunenArray.length; i++) {
    if(gorunenArray[i] === '_') {
      positions.push(i);
    }
  }
  
  if(positions.length === 0) return;
  
  const randIdx = positions[Math.floor(Math.random() * positions.length)];
  gorunenArray[randIdx] = kelimeArray[randIdx];
  document.getElementById('kelime').textContent = gorunenArray.join(' ');
  
  // Hak cezasÄ±
  yanlisSayisi++;
  document.getElementById('bilgi').textContent = "Kalan hak: " + (6 - yanlisSayisi);
  document.getElementById('bilgi').style.color = "#e94560";
  
  // AdamÄ± Ã§iz
  const parcalar = ["kafa","govde","solkol","sagkol","solbac","sagbac"];
  if (yanlisSayisi <= 6) {
    document.getElementById(parcalar[yanlisSayisi-1]).style.opacity = "1";
  }
  
  // Kazanma kontrolÃ¼
  if (!gorunenArray.includes("_")) {
    const puan = kelimeArray.length * 100 + (6 - yanlisSayisi) * 50 - 100; // usedHint true
    await handleWin(puan, true);
    return;
  }
  
  // Kaybetme kontrolÃ¼
  if (yanlisSayisi >= 6) {
    skorGuncelle(0, false);
    modalGoster("ðŸ˜¢ ÃœZGÃœNÃœM, KAYBETTÄ°N! ðŸ’€", 
      `DoÄŸru kelime: <strong>${secilenKelime}</strong><br>Tekrar dene ve rekorunu kÄ±r!`);
  }
  
  // Butonu devre dÄ±ÅŸÄ± bÄ±rak
  const btn = document.getElementById('ipucuBtn');
  btn.disabled = true;
  btn.textContent = 'Ä°pucu KullanÄ±ldÄ±';
}

// BaÅŸlat
guncelleSkorUI();
yeniOyun();

/* Auth uyarÄ±sÄ±: eÄŸer kullanÄ±cÄ± giriÅŸ yapmamÄ±ÅŸsa puanlar kaydedilemeyecek,
   bu yÃ¼zden sayfanÄ±zda login zorunlu yapÄ±yorsanÄ±z burada yÃ¶nlendirme ekleyebilirsiniz.
*/
auth.onAuthStateChanged(user => {
  if (!user) {
    // Ä°sterseniz uyarÄ± verin: console veya toast
    // console.log('GiriÅŸ yapmadÄ±nÄ±z; puanlar bakiye olarak iÅŸlenmeyecek.');
  }
});
</script>

</body>
</html>